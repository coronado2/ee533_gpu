// gpu_program.mem  –  hex words loaded by $readmemh
// Instruction format: [31:28]=opcode [27:24]=dtype [23:20]=rd [19:16]=rs1 [15:12]=rs2 [11:0]=0
//
// Opcode encodings:
//   0=VADD  1=VSUB  2=VMUL(bf16)  3=FMAC(bf16)  4=RELU
//   5=LD    6=ST    F=HALT
//
// dtype: 0=int16x4  1=bf16x4
//
// Register aliases used in kernels:
//   r0..r7  general purpose
//
// ─────────────────────────────────────────────────────────────────────────────
// Memory layout (64-bit word addresses, each address = 8 bytes):
//   0x80 (byte 0x80) / word addr 0x10  → int16 vector A  = [1,2,3,4]
//   0xA0 (byte 0xA0) / word addr 0x14  → int16 vector B  = [10,20,30,40]
//   0x100(byte)      / word addr 0x20  → bf16 vector A   = [1.0,2.0,3.0,4.0]
//   0x120(byte)      / word addr 0x24  → bf16 vector B   = [2.0,2.0,2.0,2.0]
//   0x140(byte)      / word addr 0x28  → bf16 accumulator= [1.0,1.0,1.0,1.0]
//   0x180(byte)      / word addr 0x30  → int16 negatives = [-1,-2,-3,-4]
//   0x200(byte)      / word addr 0x40  → store destination A
//   0x240(byte)      / word addr 0x48  → store destination B (bf16)
//   0x280(byte)      / word addr 0x50  → store destination C (fmac)
//
// r1 holds addresses loaded via imem immediate tricks – for behavioral sim we
// pre-load the regfile in the testbench instead of using LI instructions.
// ─────────────────────────────────────────────────────────────────────────────

// ── _Z10vadd_int16  (addr 000..004) ──────────────────────────────────────────
// LD  r0, [r1]         opcode=5 dtype=0 rd=0 rs1=1  → 50010000
// LD  r2, [r3]         opcode=5 dtype=0 rd=2 rs1=3  → 50230000
// VADD r4, r0, r2      opcode=0 dtype=0 rd=4 rs1=0 rs2=2 → 00402000
// ST  [r5], r4         opcode=6 dtype=0 rd=0 rs1=5 rs2=4 → 60054000
// HALT                 opcode=F → F0000000
50010000
50230000
00402000
60054000
F0000000

// ── _Z10vsub_int16  (addr 005..009) ──────────────────────────────────────────
// LD  r0, [r1]
// LD  r2, [r3]
// VSUB r4, r0, r2      opcode=1 dtype=0 rd=4 rs1=0 rs2=2 → 10402000
// ST  [r5], r4
// HALT
50010000
50230000
10402000
60054000
F0000000

// ── _Z10relu_int16  (addr 00A..00D) ──────────────────────────────────────────
// LD  r0, [r1]
// RELU r2, r0, r0      opcode=4 dtype=0 rd=2 rs1=0 rs2=0 → 40200000
// ST  [r3], r2         opcode=6 dtype=0 rs1=3 rs2=2 → 60032000
// HALT
50010000
40200000
60032000
F0000000

// ── _Z9vmul_bf16  (addr 00E..012) ────────────────────────────────────────────
// LD  r0, [r1]         (bf16 vector A)
// LD  r2, [r3]         (bf16 vector B)
// VMUL r4, r0, r2      opcode=2 dtype=1 rd=4 rs1=0 rs2=2 → 21402000
// ST  [r5], r4         opcode=6 dtype=1 rs1=5 rs2=4 → 61054000
// HALT
50010000
50230000
21402000
61054000
F0000000

// ── _Z9fmac_bf16  (addr 013..018) ────────────────────────────────────────────
// LD  r0, [r1]         (bf16 a)
// LD  r2, [r3]         (bf16 b)
// LD  r4, [r5]         (accumulator)
// FMAC r4, r0, r2      opcode=3 dtype=1 rd=4 rs1=0 rs2=2 → 31402000  (acc=r4)
// ST  [r6], r4         opcode=6 rs1=6 rs2=4 → 61064000
// HALT
50010000
50230000
50450000
31402000
61064000
F0000000

// ── padding to 256 entries (fill remainder with HALT = F0000000) ─────────────
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
F0000000
